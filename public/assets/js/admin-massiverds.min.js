$("#frm_massive_rds, #frm_massive_cuotas").validationEngine({autoPositionUpdate:!0,focusFirstField:!0,validateNonVisibleFields:!0,updatePromptsPosition:!0,scroll:!1,autoHidePrompt:!0,autoHideDelay:5e3,fadeDuration:400,promptPosition:"topLeft"});var tmpAnio="";$(document).on("focusin","input.year_mass_metas, input.year_mass_rds",function(e){e.preventDefault();var a=$(this);tmpAnio=$.trim(a.val())}),$(document).on("focusout","input.year_mass_metas, input.year_mass_rds",function(e){e.preventDefault();var a=$(this),t=a.closest("form"),s=$.trim(t.find("input.company_id").val())||"",n=$.trim(a.val())||"";a.validationEngine("validate")&&""!=s&&n!=tmpAnio&&$.ajax({type:"post",url:getUrlBase+"admin-empresas/semanas-get-view",dataType:"json",data:{company_id:s,year:n},beforeSend:function(e){},error:function(){}}).done(function(e){1==e.success&&""!=e.view&&(tmpAnio="",t.find("select").css({opacity:1,visibility:"visible"}).animate({opacity:0},200,function(){var a=$(this);a.html(function(){return e.view}).promise().done(function(){a.css({opacity:0,visibility:"visible"}).animate({opacity:1},200)})}));var a=processStrJson(e.msg);""!=a&&(0==e.success?$.alert({icon:"fa fa-red",title:"¡Ups! encontramos estos detalles",content:a,type:"orange",typeAnimated:!0,columnClass:"col-md-10 mx-auto",typeAnimated:!0,buttons:{continuar:{}}}):$.alert({icon:"fa fa-check",title:"Carga exitosa",content:a,type:"green",typeAnimated:!0,buttons:{continuar:{}}}))}).fail(function(e){return 401==e.status?(location.reload(),!1):void msg_ups()})}),$(document).on("change","#fileupload_cuotas",function(){var e=$(this).val();e.length>0?$(".file-name-cuotas").html(e):$(".file-name-cuotas").html("")}),$(document).on("change","#fileupload",function(){var e=$(this).val();e.length>0?$(".file-name").html(e):$(".file-name").html("")}),$(document).on("click",".upload-massive-cuota",function(e){e.preventDefault();var a=$(this);if($("#frm_massive_cuotas").validationEngine("validate")){var t=new FormData($("#frm_massive_cuotas")[0]);$.ajax({type:"post",url:getUrlBase+"admin-empresas/import-cuotas-sucursal",dataType:"json",data:t,cache:!1,contentType:!1,processData:!1,beforeSend:function(e){$("#frm_massive_cuotas .alert-ajax").html(""),""!=a&&(a.addClass("disabled"),a.append('<i class="fa fa-spin fa-spinner"></i>'))},error:function(){""!=a&&a.find("i.fa-spinner").remove()}}).done(function(e){""!=a&&(a.removeClass("disabled"),a.find("i.fa-spinner").remove()),1==e.success&&($("#frm_massive_cuotas select").val(""),$("#frm_massive_cuotas #fileupload").val(""),$("#frm_massive_cuotas .file-name").html(""));var t=processStrJson(e.msg);""!=t&&(0==e.success?$.alert({icon:"fa fa-red",title:"¡Ups! encontramos estos detalles",content:t,type:"orange",typeAnimated:!0,columnClass:"col-md-10 mx-auto",typeAnimated:!0,buttons:{continuar:{}}}):$.alert({icon:"fa fa-check",title:"Carga exitosa",content:t,type:"green",typeAnimated:!0,buttons:{continuar:{}}}))}).fail(function(e){return 401==e.status?(location.reload(),!1):(""!=a&&a.removeClass("disabled"),void msg_ups())})}}),$(document).on("click",".upload-massiverds",function(e){e.preventDefault();var a=$(this);if($("#frm_massive_rds").validationEngine("validate")){var t=new FormData($("#frm_massive_rds")[0]);$.ajax({type:"post",url:getUrlBase+"admin-empresas/import-rds-empresa",dataType:"json",data:t,cache:!1,contentType:!1,processData:!1,beforeSend:function(e){$("#frm_massive_rds .alert-ajax").html(""),""!=a&&(a.addClass("disabled"),a.append('<i class="fa fa-spin fa-spinner"></i>'))},error:function(){""!=a&&a.find("i.fa-spinner").remove()}}).done(function(e){""!=a&&(a.removeClass("disabled"),a.find("i.fa-spinner").remove()),1==e.success&&($("#frm_massive_rds select").val(""),$("#frm_massive_rds #fileupload").val(""),$("#frm_massive_rds .file-name").html(""));var t=processStrJson(e.msg);""!=t&&(0==e.success?$.alert({icon:"fa fa-red",title:"¡Ups! encontramos estos detalles",content:t,type:"orange",typeAnimated:!0,columnClass:"col-md-10 mx-auto",typeAnimated:!0,buttons:{continuar:{}}}):$.alert({icon:"fa fa-check",title:"Carga exitosa",content:t,type:"green",typeAnimated:!0,buttons:{continuar:{}}}))}).fail(function(e){return 401==e.status?(location.reload(),!1):(""!=a&&a.removeClass("disabled"),void msg_ups())})}});